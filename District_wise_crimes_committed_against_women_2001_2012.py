#!/usr/bin/env python
# coding: utf-8

# # Phase 1

# Skip to content						
# Find Easy						
# Find Easy						
# Exploring Population & more						
# World Population						
# World Religion						
# Indian States						
# Indian Cities						
# Literary Rate in India 2023						
# The literacy rate is defined as the percentage of literate persons of age 7 years and above. A person who can read and write a simple message in any language with understanding is considered literate. 						
# According to the 2011 Census, there are 763,498,517 (76.34 crores) literate individuals in the country. Out of these, 434,683,779 (43.46 crore) are males and 328,814,738 (32.88 crore) are females. The overall literacy rate is 72.9%, with the male literacy rate at 80.89% and the female literacy rate at 64.64%. 						
# Based on data from the National Statistical Office (NSO)						
# India’s average literacy rate as of 2021 is 77.70%.						
# At the national level, male literacy stands at 84.70%						
# Female literacy stands at 70.30%.						
# #	Literate Population 2011	Literacy Rate 2011	Literacy Rate 2021			
# Persons	76,34,98,517	72.99%	77.70%			
# Males	43,46,83,779	80.89%	84.70%			
# Females	32,88,14,738	64.64%	70.30%			
# According to the National Family Health Survey 2019-21 (NFHS-5), adult women (aged 15-49) have a literacy rate of 71.5%, while adult men (aged 15-49) have a literacy rate of 87.4%.						
# Source: Census 2011, National Statistical Office (NSO) & National Family health Survey (NFHS-5) 						
# Table of Contents						
# State Wise Literacy Rate in India						
# Indian States with High Literacy Rate						
# Indian States with Low Literacy Rate						
# Literary Rate Urban Vs Rural						
# Educational level of Different age groups						
# 						
# State Wise Literacy Rate in India						
# Kerala at 96.2% is the state with the Highest Literacy rate and Andhra Pradesh’s literacy rate of 66.4% is the lowest among all states in India. The Male-Female gap at the all-India level is 12.9 % points with male literacy at 84.7% and female literacy at 70.3%. The gap between male and female literacy is the smallest in Kerala at just 2.2 % points and highest in Rajasthan at 23.3 %.						
# Below is the list of States & Union Territories with literacy rates.						
# States & UTs 	Male	Female	Average			
# 	Literacy Rate %	Literacy Rate %	Literacy Rate %			
# A&N islands	90.11	81.84	86.27			
# Andhra Pradesh	73.4	59.5	66.4			
# Arunachal Pradesh	73.69	59.57	66.95			
# Assam	90.1	81.2	85.9			
# Bihar	79.7	60.5	70.9			
# Chhattisgarh	85.4	68.7	77.3			
# Chandigarh	90.54	81.38	86.43			
# Dadra and Nagar Haveli	86.46	65.93	77.65			
# Daman & Diu	91.48	79.59	87.07			
# Delhi	93.7	82.4	88.7			
# Goa	92.81	81.84	87.4			
# Gujarat	89.5	74.8	82.4			
# Haryana	88	71.3	80.4			
# Himachal Pradesh	92.9	80.5	86.6			
# Jammu & Kashmir	85.7	68	77.3			
# Jharkhand	83	64.7	74.3			
# Karnataka	83.4	70.5	77.2			
# Kerala	97.4	95.2	96.2			
# Lakshadweep	96.11	88.25	92.28			
# Madhya Pradesh	81.2	65.5	73.7			
# Maharashtra	90.7	78.4	84.8			
# Manipur	86.49	73.17	79.85			
# Meghalaya	77.17	73.78	75.48			
# Mizoram	93.72	89.4	91.58			
# Nagaland	83.29	76.69	80.11			
# Odisha	84	70.3	77.3			
# Puducherry	92.12	81.22	86.55			
# Punjab	88.5	78.5	83.7			
# Rajasthan	80.8	57.6	69.7			
# Sikkim	87.29	76.43	82.2			
# Tamil Nadu	87.9	77.9	82.9			
# Telangana	80.5	65.1	72.8			
# Tripura	92.18	83.15	87.75			
# Uttarakhand	94.3	80.7	87.6			
# Uttar Pradesh	81.8	63.4	73			
# West Bengal	84.8	76.1	80.5			
# All-India 	84.7	70.3	77.7			
# Source: Survey by National Statistical Office (NSO). *UTs & NE States based on 2011 Census						
# Indian States with High Literacy Rate						
# As per the National Statistical Office (NSO) data on state-wise literacy rate in the country Kerala ranked highest in the list with 96.2%. Next comes Mizoram at 91.58% followed by Delhi at third with 88.7%.						
# Top 10 States with Highest Literacy Rate						
# #	State	Male	Female 	Average		
# 1	Kerala	97.4	95.2	96.2		
# 2	Mizoram	93.72	89.4	91.58		
# 3	Delhi	93.7	82.4	88.7		
# 4	Tripura	92.18	83.15	87.75		
# 5	Uttarakhand	94.3	80.7	87.6		
# 6	Goa	92.81	81.84	87.4		
# 7	Himachal Pradesh	92.9	80.5	86.6		
# 8	Assam	90.1	81.2	85.9		
# 9	Maharashtra	90.7	78.4	84.8		
# 10	Punjab	88.5	78.5	83.7		
# Source: survey by National Statistical Office (NSO). *UTs & NE States based on the 2011 Census						
# Indian States with Low Literacy Rate						
# As per the National Statistical Office (NSO) data on state-wise literacy rate in the country, Andhra Pradesh ranked Lowest in the list with 66.2% followed by Rajasthan (69.7%) and Bihar (70.9%).						
# States with the Lowest Literacy Rate						
# #	State	Male	Female 	Average		
# 1	Andhra Pradesh	73.4	59.5	66.4		
# 2	Rajasthan	80.8	57.6	69.7		
# 3	Bihar	79.7	60.5	70.9		
# 4	Telangana	80.5	65.1	72.8		
# 5	Uttar Pradesh	81.8	63.4	73		
# 6	Madhya Pradesh	81.2	65.5	73.7		
# 7	Jharkhand	83	64.7	74.3		
# 8	Karnataka	83.4	70.5	77.2		
# 9	Chhattisgarh	85.4	68.7	77.3		
# 10	Jammu & Kashmir	85.7	68	77.3		
# Source: survey by National Statistical Office (NSO). *UTs & NE States based on 2011 Census						
# Literary Rate Urban Vs Rural						
# The literacy rate among persons (aged 7 years and above) in India was about 77.7%. In rural areas, the literacy rate was 73.5% compared to 87.7% in urban areas.						
# States	Rural Literacy Rate			Urban Literacy Rate		
# 	Male	Female	Average	Male	Female	Average
# Andhra Pradesh	67.5	53.4	60.4	86.3	73.1	79.6
# Assam	89.4	79.9	84.9	96.1	91.4	93.8
# Bihar	78.6	58.7	69.5	89.3	75.9	83.1
# Chhattisgarh	84	65.6	75	91.8	82.3	87.2
# Delhi				94.1	83.4	89.4
# Gujarat	85.7	68	77	95.2	86.3	91.1
# Haryana	85.8	66.4	77	92.5	81.2	87.3
# Himachal Pradesh	92.3	79.2	85.6	97.8	93	95.5
# Jammu & Kashmir	84.9	66	75.8	88.5	75.7	82.6
# Jharkhand	80.6	61.4	71.4	92.6	78.6	86.1
# Karnataka	78.2	63.1	71	92.5	83.7	88.3
# Kerala	96.7	94.1	95.4	98.2	96.4	97.3
# Madhya Pradesh	77.9	61	69.8	91.4	79.5	85.8
# Maharashtra	87	71.4	79.4	95.3	87.6	91.7
# Odisha	82	67.3	74.9	94.4	85.9	90.2
# Punjab	85.5	74	80	93.8	86.7	90.5
# Rajasthan	77.6	52.6	65.5	91.1	74.6	83.5
# Tamil Nadu	84.2	70.8	77.5	92.3	85.9	89
# Telangana	70.6	53.7	62.1	91.7	79	85.5
# Uttarakhand	93.1	79	86.1	97.4	85.9	92
# Uttar Pradesh	80.5	60.4	70.8	86.8	74.9	81.2
# West Bengal	82	72.6	77.4	91.4	84.7	88.1
# All-India 	81.5	65	73.5	92.2	82.8	87.7
# 						
# Educational level of Different age groups						
# Percentage distribution of rural persons ( ages 15 years & above by highest completed levels of education)						
# 31.5% were not literate,						
# 20.9% were literate up to primary						
# 17.2% were of level upper primary/middle,						
# 24.9% were of levels secondary and higher secondary						
# 5.7% were graduates & above.						
# Percentage distribution of urban persons  (age 15 years & above by highest completed level of education)						
# 13.9% were not literate,						
# 14.7% were literate up to the primary,						
# 14.0% were of level upper primary/middle,						
# 35.8% were of level secondary and higher secondary						
# 21.7% were graduates & above						
# Source: survey by National Statistical Office (NSO)						
# Other Topics that may interest you						
# Literacy rate in India						
# Sex ratio in India and states						
# Indian States by Area 						
# Indian States by Religion						
# Indian States by Fertility Rate						
# Indian States by Literacy Rate						
# Most Populated Indian Cities						
# List of Distrits in India						
# Tagged on: Female Literary Rate    Indian States with Highest Literacy Rate    Indian States with Lowest Literacy Rate    List of States & Union Territories by Literary Rate 2021    Literary Rate of India 2021						
# adminOctober 24, 2023India Population, Statistics India						
# ← Population of Tirunelveli 2023 | Tirunelveli District Population						
# Police Stations in Chennai | Chennai Police Station List →						
# You May Also Like						
# Population of Bhopal						
# Population of Bhopal 2023 | Bhopal City Population						
# admin July 22, 2020						
# Population of Bhiwani 2023 | Bhiwani District Population						
# admin February 10, 2021						
# Indian States by Rice production 2023 | Rice Cultivation in India						
# admin October 25, 2023						
# Copyright © 2023 Find Easy. All rights reserved. Theme Spacious by ThemeGrill. Powered by: WordPress.						
# World Population						
# World Religion						
# Indian States						
# Indian Cities						
# 

# # phase 2 and phase 3

# In[2]:


# Import libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

import warnings
warnings.filterwarnings('ignore')


# In[3]:


# Importing dataset
crimes_df = pd.read_csv(r"C:\file01\42_District_wise_crimes_committed_against_women_2001_2012.csv")


# In[4]:


crimes_df


# In[5]:


crimes_df.head(2)


# Data Cleaning 
# 
# Check dtypes

# In[6]:


print(f'''(crimes_df = \n{crimes_df.dtypes})''' )


# In[7]:


crimes_df.tail(4)


# In[8]:


# renaming the columns for better understanding 

crimes_df.columns = ["state/ut", "district","year","rape","kidnapping","dowry_deaths","assault","insult_to_modesty",
                 "cruelty_by_husband","trafficking"]


# In[9]:


crimes_df.rename(columns = {'State / Union Territory (UT)':'state/ut'}, inplace=True)


# Check null values

# In[10]:


crimes_df.isnull().sum()


# Check data column state/ut for merge ready
# State and UT nmaes are differently and misplaced in our dataframes. Let's replace them with similar names so our data will be merge ready on state/ut column
# Renaming of columns for merge ease

# Crimes_df

# In[11]:


crimes_df


# In[12]:


# crime data pull only year 2011 because census happens every 10th year in India.

columns = ["rape","kidnapping","dowry_deaths","assault","insult_to_modesty",
           "cruelty_by_husband","trafficking"]
crimes_df_2011 = crimes_df[crimes_df['year']==2011]

# create total_crime column 

sum_cols = ["rape","kidnapping","dowry_deaths","assault","insult_to_modesty",
        "cruelty_by_husband","trafficking"]
crimes_df_2011['total_crimes'] = crimes_df_2011[sum_cols].sum(axis=1)




# In[13]:


columns


# In[14]:


sum_cols


# In[15]:


crimes_df_2011['total_crimes']


# In[16]:


# Crime analysis 

class crime_analysis:
    
    def __init__(self, df, crime_columns, shp_gdf):
        self.df = df
        self.crime_columns = crime_columns
        self.shp_gdf = shp_gdf
        
    # States with max crimes
    def plot_st_max_crime(self, df, shp_gdf):
        
        # Pull state data
        self.merged_st_data = df.groupby('state/ut')['total_crimes'].sum()

        self.merged_new = shp_gdf.set_index('st_nm').join(self.merged_st_data)

        # Geoplot
        fig, ax = plt.subplots(1, figsize=(12, 12))
        ax.axis('off')
        ax.set_title('Total crimes on women in India as of 2011',
                     fontdict={'fontsize': '15', 'fontweight' : '3'})

        fig = self.merged_new.plot(column='total_crimes', cmap='Reds', linewidth=0.5, 
                                   ax=ax, edgecolor='0.2',legend=True, legend_kwds={'label': "Number of crimes"})
        
        # Top 10 states histplot
        self.merged_crime = df.sort_values(by = 'total_crimes', ascending=False).head(10)
        
        # adding color palette
        pal = sns.color_palette("Reds_d", 10)
        plt.figure(figsize=(14, 5))
        sns.barplot(data=self.merged_crime, x=self.merged_crime['state/ut'], y='total_crimes', 
                    palette=np.array(pal[::-1]))
        
        plt.show()
    
    # Create dataframe for each crime category 
    def create_crime_df(self, df, crime_columns):
        
        self.df_arr = []
        for crime_col in crime_columns:
            self.df_arr.append(pd.DataFrame(df.groupby(['state/ut','year'])[crime_col].sum().reset_index()))
        return self.df_arr
    
    # Pull Top 5 states contents for each crime category
    def create_top_5_crime_df(self, df, crime_columns):
        
        # call create_crime_df function
        self.df_a = self.create_crime_df(df, crime_columns)
        
        self.df_tp_5_a = []
        for df in self.df_a:
            self.df_tp_5_a.append(df[(df['state/ut']=="uttarpradesh") |                              (df['state/ut']=='westbengal') |                              (df['state/ut']=='andhrapradesh') |                              (df['state/ut']=='madhyapradesh') |                              (df['state/ut']=='rajasthan')])
        return self.df_tp_5_a
    
    # Plot each crime category graph for Top 5 states
    def plot_crime_top_5_st_graph(self, df, crime_columns):
        
        # call create top 5 crime df function
        self.df_tp_5_arr = self.create_top_5_crime_df(df, crime_columns)
        
        fig1, ax1 = plt.subplots(nrows=3, ncols=2, sharex=True, sharey=False, figsize=(19,7))
        
        ax1 = ax1.ravel()
        
        for i in range(len(self.df_tp_5_arr)):
            
            ax1[i].scatter(self.df_tp_5_a[i]['state/ut'], self.df_tp_5_a[i].iloc[:,-1:])
            ax1[i].set(ylabel=f'{self.df_tp_5_a[i].columns[2]} cases')
            ax1[i].set_title(f'Number of {self.df_tp_5_a[i].columns[2]} crime cases')
        


# In[17]:


# Creating class pointer for further analysis:
crime_columns = ['rape', 'kidnapping', 'dowry_deaths', 
                  'cruelty_by_husband', 'assault', 'trafficking']


# In[18]:


crime_columns


# In[19]:


# Crime analysis Class pointer
ca = crime_analysis(crimes_df, crime_columns, crimes_df_2011)


# In[20]:


ca


# In[21]:


crimes_df.head()


# In[23]:


crimes_df.info()


# In[24]:


# Shape of dataset
print('Rows: {} Columns: {}'.format(crimes_df.shape[0], crimes_df.shape[1]))


# In[25]:


# Statistical summary
crimes_df.describe().T


# In[26]:


# Check for null values
round((crimes_df.isnull().sum() / crimes_df.shape[0]) * 100, 2).astype(str) + ' %'


# In[27]:


# Check for '?' in dataset
round((crimes_df.isin(['?']).sum() / crimes_df.shape[0])
      * 100, 2).astype(str) + ' %'


# In[32]:


from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
crimes_df['rape'] = le.fit_transform(crimes_df['rape'])
# Creating a pairplot of dataset
sns.pairplot(crimes_df)
plt.savefig('multi1.png')
plt.show()


# In[33]:


from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
crimes_df['state/ut'] = le.fit_transform(crimes_df['state/ut'])
# Creating a pairplot of dataset
sns.pairplot(crimes_df)
plt.savefig('multi1.png')
plt.show()


# In[34]:


corr = crimes_df.corr()
mask = np.zeros_like(corr)
mask[np.triu_indices_from(mask)] = True
with sns.axes_style("white"):
    f, ax = plt.subplots(figsize=(7, 5))
    ax = sns.heatmap(corr, mask=mask, vmax=.3, square=True,
                     annot=True, cmap='RdYlGn')
plt.savefig('multi2.png')
plt.show()


# In[35]:


crimes_df = crimes_df.replace('?', np.nan)
# Checking null values
round((crimes_df.isnull().sum() / crimes_df.shape[0]) * 100, 2).astype(str) + ' %'


# In[36]:


sns.heatmap(crimes_df.isnull())
plt.show()


# In[37]:


crimes_df.isna().sum()


# In[38]:


crimes_df.columns


# In[39]:


crimes_df.dtypes


# In[40]:


crimes_df.drop(['district'],axis=1,inplace=True)
crimes_df.head()


# In[41]:


crimes_df.columns


# In[42]:


crimes_df['kidnapping'].unique()


# In[43]:


crimes_df['rape'].unique()


# In[44]:


crimes_df['dowry_deaths'].unique()


# In[45]:


crimes_df['state/ut'].unique()


# In[46]:


sns.histplot('rape')
plt.show()


# In[47]:


sns.histplot('kidnapping')
plt.show()


# In[48]:


from sklearn.preprocessing import LabelEncoder # import


# In[52]:


le=LabelEncoder()
for i in crimes_df.drop(['rape'],axis=1):
    crimes_df[i]=le.fit_transform(crimes_df[i])
crimes_df


# In[53]:


crimes_df.corr()


# In[59]:


plt.figure(figsize=(1,9))
sns.heatmap(crimes_df.corr(),annot=True)


# In[ ]:




